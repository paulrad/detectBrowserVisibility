var detectBrowserVisibility=function(e){e=e||{},e.forceOldBrowsersMethod=e.forceOldBrowsersMethod||!1;var n={onActive:function(){},onDisabled:function(){}},i={hidden:"visibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange",webkitHidden:"webkitvisibilitychange"},t=!1;if(e.forceOldBrowsersMethod===!1)for(var o in i)if("undefined"!=typeof document[o]){document.hidden=document[o],document.addEventListener(i[o],function(){n[document.hidden?"onDisabled":"onActive"]()},!1),t=!0;break}return(e.forceOldBrowsersMethod===!0||t===!1)&&("function"==typeof document.addEventListener?(window.addEventListener("focus",n.onActive,!0),window.addEventListener("blur",n.onDisabled,!0)):(window.attachEvent("focus",n.onActive,!0),window.attachEvent("blur",n.onDisabled,!0))),new function(){return{onActive:function(e){return n.onActive=e,this},onDisabled:function(e){return n.onDisabled=e,this}}}};